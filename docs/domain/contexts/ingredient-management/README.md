# 食材管理コンテキスト（Ingredient Management Context）

## 概要

食材管理コンテキストは、食材の在庫管理、賞味期限管理、カテゴリー・単位管理を担当する中核的なビジネスドメインです。
一人暮らしの方が食材の無駄を削減し、効率的な買い物ができるよう支援します。

## コンテキストの詳細

### ビジネス上の目的

- 食材の無駄を削減する
- 賞味期限切れによる廃棄を防ぐ
- 買い物前の在庫確認を容易にする
- 食材の使用履歴から消費パターンを把握する

### 主要な責務

- 食材の登録・更新・削除
- 在庫数量の管理と追跡
- 賞味期限・消費期限の管理と通知
- カテゴリーによる食材の分類
- 単位の管理（個、g、ml等）
- 保存場所の管理（冷蔵、冷凍、常温）

### このコンテキストに含まれるもの

- 食材の基本情報（名前、カテゴリー、保存方法）
- 在庫情報（数量、単位、保存場所）
- 期限情報（賞味期限、消費期限）
- カテゴリーマスタ
- 単位マスタ
- 在庫履歴

### このコンテキストに含まれないもの

- レシピ情報（レシピ管理コンテキストの責務）
- 買い物リストの生成（買い物リストコンテキストの責務）
- 献立の提案（献立計画コンテキストの責務）
- ユーザー認証・認可（ユーザー管理コンテキストの責務）

## ドメインエキスパート

- 主婦/主夫: 日常的な食材管理の実践者
- 栄養士: 食材の分類や保存方法の専門知識
- 一人暮らしの方: 実際のエンドユーザー

## 関連するコンテキスト

### 上流コンテキスト

- **共有カーネル**: 共通の値オブジェクトを提供

### 下流コンテキスト

- **レシピ管理**: 食材の在庫情報を参照
- **買い物リスト**: 在庫不足の食材情報を利用
- **献立計画**: 食材の在庫と期限情報を参照
- **通知**: 期限切れ間近イベントを受信

### 統合方法

- **レシピ管理との統合**: Customer/Supplierパターン
  - 食材の在庫確認API
  - 食材詳細情報API
- **通知との統合**: Published Languageパターン
  - ドメインイベントの発行
  - 標準化されたイベント形式

## 主要なドメイン概念

### エンティティ

- **食材（Ingredient）**: 在庫管理の対象となる個々の食材
- **カテゴリー（Category）**: 食材を分類するためのマスタ
- **単位（Unit）**: 数量を表現するためのマスタ

### 値オブジェクト

- **食材ID（IngredientId）**: 食材の一意識別子
- **食材名（IngredientName）**: 食材の名称
- **数量（Quantity）**: 数値と単位の組み合わせ
- **賞味期限（BestBeforeDate）**: 品質保証期限
- **消費期限（ExpiryDate）**: 安全に消費できる期限
- **保存場所（StorageLocation）**: 冷蔵/冷凍/常温
- **金額（Money）**: 価格情報

### ドメインサービス

- **在庫チェックサービス**: 複数食材の在庫確認
- **期限管理サービス**: 期限切れチェックと通知
- **カテゴリー分類サービス**: 食材の適切なカテゴリー判定

### ドメインイベント

- **食材登録イベント**: 新しい食材が登録された
- **在庫更新イベント**: 食材の数量が変更された
- **期限切れ間近イベント**: 賞味期限が7日以内に迫った
- **在庫不足イベント**: 在庫が閾値を下回った
- **食材削除イベント**: 食材が削除された

## ビジネスルール

### 不変条件

1. 食材の数量は0以上でなければならない
2. 消費期限は賞味期限より前または同日でなければならない
3. 食材は必ず1つのカテゴリーに属する
4. 数量には必ず単位が設定される
5. 同じ名前・賞味期限・保存場所の食材は重複登録できない

### ビジネス制約

- 期限切れの食材は自動的に警告表示される
- 在庫が設定した閾値を下回ったら通知する
- 賞味期限まで7日以内の食材は「期限切れ間近」として扱う
- 削除された食材も履歴として保持する（論理削除）

## 実装上の考慮事項

### パフォーマンス要件

- 食材一覧の表示は100件でも1秒以内
- 検索・フィルタリング処理は500ms以内
- 在庫更新は即座に反映される

### スケーラビリティ

- 1ユーザーあたり最大1000件の食材を想定
- 将来的なマルチユーザー対応を考慮
- イベント駆動による疎結合な設計

### セキュリティ

- ユーザーは自分の食材のみアクセス可能
- 削除は論理削除として履歴を保持
- APIレベルでの認証・認可

## 関連ドキュメント

このコンテキストの詳細設計は以下のドキュメントを参照：

- [ドメイン分析](./domain-analysis.md)
- [ドメインモデル](./domain-model.md)
- [集約設計](./aggregates.md)
- [ドメインイベント](./domain-events.md)
- [リポジトリ仕様](./repositories.md)
- [ドメインサービス](./domain-services.md)
- [アプリケーションサービス](./application-services.md)
- [ユビキタス言語](./ubiquitous-language.md)

## 変更履歴

| 日付       | 内容     | 作成者  |
| ---------- | -------- | ------- |
| 2025-01-21 | 初版作成 | @system |

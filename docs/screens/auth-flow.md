# èªè¨¼ãƒ•ãƒ­ãƒ¼ç”»é¢

## æ¦‚è¦

NextAuthã®ãƒã‚¸ãƒƒã‚¯ãƒªãƒ³ã‚¯èªè¨¼ã«æœ€é©åŒ–ã•ã‚ŒãŸèªè¨¼ãƒ•ãƒ­ãƒ¼ã€‚ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒ¬ã‚¹èªè¨¼ã«ã‚ˆã‚Šã€ã‚»ã‚­ãƒ¥ã‚¢ã§ä½¿ã„ã‚„ã™ã„èªè¨¼ä½“é¨“ã‚’æä¾›ã™ã‚‹ã€‚

## èªè¨¼ãƒ•ãƒ­ãƒ¼å…¨ä½“

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ãƒ­ã‚°ã‚¤ãƒ³   â”‚ -> â”‚ ãƒ¡ãƒ¼ãƒ«ç¢ºèª  â”‚ -> â”‚ ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ â”‚
â”‚   ç”»é¢      â”‚    â”‚   ç”»é¢      â”‚    â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                   â”‚
       v                   v
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ èªè¨¼ã‚¨ãƒ©ãƒ¼  â”‚    â”‚ èªè¨¼å‡¦ç†ä¸­  â”‚
â”‚   ç”»é¢      â”‚    â”‚   ç”»é¢      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 1. ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢

### UIè¦ä»¶

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         â”‚
â”‚          ğŸ¥—              â”‚
â”‚     é£Ÿæç®¡ç†ã‚¢ãƒ—ãƒª        â”‚
â”‚                         â”‚
â”‚   ä¸€äººæš®ã‚‰ã—ã®é£Ÿæç®¡ç†ã‚’   â”‚
â”‚     ã‚‚ã£ã¨ã‚·ãƒ³ãƒ—ãƒ«ã«      â”‚
â”‚                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚  ğŸ“§                 â”‚ â”‚
â”‚ â”‚  ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹      â”‚ â”‚
â”‚ â”‚  [example@gmail.com]â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚  ãƒ­ã‚°ã‚¤ãƒ³ãƒªãƒ³ã‚¯ã‚’é€ä¿¡  â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                         â”‚
â”‚ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯ä¸è¦ã§ã™âœ¨     â”‚
â”‚                         â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚                         â”‚
â”‚ åˆã‚ã¦ã”åˆ©ç”¨ã®æ–¹ã‚‚        â”‚
â”‚ åŒã˜æ‰‹é †ã§å§‹ã‚ã‚‰ã‚Œã¾ã™    â”‚
â”‚                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è©³ç´°ä»•æ§˜

#### ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæ§‹æˆ

```typescript
interface LoginPageProps {
  callbackUrl?: string
  error?: string
}

const LoginPage = ({ callbackUrl, error }: LoginPageProps) => {
  const [email, setEmail] = useState('')
  const [isLoading, setIsLoading] = useState(false)
  const { signIn } = useNextAuth()

  const handleSubmit = async (e: FormEvent) => {
    e.preventDefault()
    setIsLoading(true)

    try {
      const result = await signIn('email', {
        email,
        callbackUrl: callbackUrl || '/dashboard',
        redirect: false
      })

      if (result?.ok) {
        router.push(`/auth/verify-request?email=${encodeURIComponent(email)}`)
      } else {
        router.push('/auth/error?error=Signin')
      }
    } catch (error) {
      console.error('Sign in error:', error)
      router.push('/auth/error?error=Signin')
    } finally {
      setIsLoading(false)
    }
  }

  return (
    <div className="min-h-screen bg-gradient-to-b from-green-50 to-white">
      {/* UI implementation */}
    </div>
  )
}
```

#### ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³

```typescript
const emailValidation = {
  required: true,
  pattern: /^[^\s@]+@[^\s@]+\.[^\s@]+$/,
  message: 'æœ‰åŠ¹ãªãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„',
}

const validateEmail = (email: string): boolean => {
  return emailValidation.pattern.test(email)
}
```

#### UXé…æ…®

- **ã‚·ãƒ³ãƒ—ãƒ«ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸**: ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ä¸è¦ã®æ˜ç¢ºãªèª¬æ˜
- **ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼**: å…·ä½“çš„ãªãƒ¡ãƒ¼ãƒ«ä¾‹ã‚’è¡¨ç¤º
- **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**: åˆ†ã‹ã‚Šã‚„ã™ã„ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
- **ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹**: é€ä¿¡ä¸­ã®è¦–è¦šçš„ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯

## 2. ãƒ¡ãƒ¼ãƒ«ç¢ºèªç”»é¢

### UIè¦ä»¶

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Header                  â”‚
â”‚ [â† æˆ»ã‚‹] ãƒ¡ãƒ¼ãƒ«ç¢ºèª      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                         â”‚
â”‚          ğŸ“§              â”‚
â”‚                         â”‚
â”‚   ãƒ¡ãƒ¼ãƒ«ã‚’é€ä¿¡ã—ã¾ã—ãŸ    â”‚
â”‚                         â”‚
â”‚  example@gmail.com ã«   â”‚
â”‚  ãƒ­ã‚°ã‚¤ãƒ³ãƒªãƒ³ã‚¯ã‚’é€ä¿¡     â”‚
â”‚  ã—ã¾ã—ãŸã€‚              â”‚
â”‚                         â”‚
â”‚  ãƒ¡ãƒ¼ãƒ«ã‚’ã”ç¢ºèªãã ã•ã„   â”‚
â”‚                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚  ãƒ¡ãƒ¼ãƒ«ã‚’å†é€ä¿¡      â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                         â”‚
â”‚ ãƒ¡ãƒ¼ãƒ«ãŒå±Šã‹ãªã„å ´åˆï¼š    â”‚
â”‚ â€¢ è¿·æƒ‘ãƒ¡ãƒ¼ãƒ«ãƒ•ã‚©ãƒ«ãƒ€ã‚’   â”‚
â”‚   ç¢ºèªã—ã¦ãã ã•ã„      â”‚
â”‚ â€¢ æ•°åˆ†ãŠå¾…ã¡ãã ã•ã„     â”‚
â”‚                         â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚                         â”‚
â”‚ åˆ¥ã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã§     â”‚
â”‚ ã‚„ã‚Šç›´ã™                â”‚
â”‚                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è©³ç´°ä»•æ§˜

#### ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå®Ÿè£…

```typescript
interface VerifyRequestPageProps {
  email?: string
}

const VerifyRequestPage = ({ email }: VerifyRequestPageProps) => {
  const [isResending, setIsResending] = useState(false)
  const [resendCount, setResendCount] = useState(0)
  const [lastResent, setLastResent] = useState<Date | null>(null)

  // å†é€ä¿¡åˆ¶é™ï¼ˆ1åˆ†é–“ã«1å›ã¾ã§ï¼‰
  const canResend = !lastResent ||
    (Date.now() - lastResent.getTime()) > 60000

  const handleResend = async () => {
    if (!email || !canResend || isResending) return

    setIsResending(true)
    try {
      await signIn('email', {
        email,
        redirect: false
      })
      setResendCount(prev => prev + 1)
      setLastResent(new Date())
      toast.success('ãƒ¡ãƒ¼ãƒ«ã‚’å†é€ä¿¡ã—ã¾ã—ãŸ')
    } catch (error) {
      toast.error('å†é€ä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸ')
    } finally {
      setIsResending(false)
    }
  }

  return (
    <div className="min-h-screen bg-white">
      {/* UI implementation */}
    </div>
  )
}
```

#### è‡ªå‹•ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ

```typescript
// ãƒ¡ãƒ¼ãƒ«ç¢ºèªå¾Œã®è‡ªå‹•ãƒ­ã‚°ã‚¤ãƒ³æ¤œçŸ¥
useEffect(() => {
  const checkAuthStatus = () => {
    if (session?.user) {
      router.push('/dashboard')
    }
  }

  // 5ç§’é–“éš”ã§ã‚»ãƒƒã‚·ãƒ§ãƒ³çŠ¶æ…‹ã‚’ãƒã‚§ãƒƒã‚¯
  const interval = setInterval(checkAuthStatus, 5000)

  return () => clearInterval(interval)
}, [session, router])
```

## 3. èªè¨¼ã‚¨ãƒ©ãƒ¼ç”»é¢

### UIè¦ä»¶

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Header                  â”‚
â”‚ [â† æˆ»ã‚‹] ã‚¨ãƒ©ãƒ¼          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                         â”‚
â”‚          âš ï¸              â”‚
â”‚                         â”‚
â”‚   ãƒ­ã‚°ã‚¤ãƒ³ã«å¤±æ•—ã—ã¾ã—ãŸ  â”‚
â”‚                         â”‚
â”‚  ç”³ã—è¨³ã”ã–ã„ã¾ã›ã‚“ã€‚     â”‚
â”‚  èªè¨¼å‡¦ç†ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒ     â”‚
â”‚  ç™ºç”Ÿã—ã¾ã—ãŸã€‚          â”‚
â”‚                         â”‚
â”‚  ã—ã°ã‚‰ãæ™‚é–“ã‚’ãŠã„ã¦     â”‚
â”‚  å†åº¦ãŠè©¦ã—ãã ã•ã„ã€‚     â”‚
â”‚                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚  ã‚‚ã†ä¸€åº¦ãƒ­ã‚°ã‚¤ãƒ³    â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚  ãƒ˜ãƒ«ãƒ—ã‚»ãƒ³ã‚¿ãƒ¼      â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                         â”‚
â”‚ å•é¡ŒãŒç¶šãå ´åˆã¯         â”‚
â”‚ ãŠå•ã„åˆã‚ã›ãã ã•ã„     â”‚
â”‚                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ã‚¨ãƒ©ãƒ¼ç¨®åˆ¥å¯¾å¿œ

```typescript
interface AuthErrorInfo {
  type: string
  title: string
  message: string
  actionText: string
  showHelp: boolean
}

const authErrors: Record<string, AuthErrorInfo> = {
  Signin: {
    type: 'signin',
    title: 'ãƒ­ã‚°ã‚¤ãƒ³ã«å¤±æ•—ã—ã¾ã—ãŸ',
    message: 'ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ã”ç¢ºèªã„ãŸã ãã€å†åº¦ãŠè©¦ã—ãã ã•ã„ã€‚',
    actionText: 'ã‚‚ã†ä¸€åº¦ãƒ­ã‚°ã‚¤ãƒ³',
    showHelp: true,
  },
  OAuthSignin: {
    type: 'oauth',
    title: 'èªè¨¼ã«å¤±æ•—ã—ã¾ã—ãŸ',
    message: 'èªè¨¼ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã¨ã®é€£æºã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚',
    actionText: 'ã‚‚ã†ä¸€åº¦è©¦ã™',
    showHelp: true,
  },
  OAuthCallback: {
    type: 'callback',
    title: 'èªè¨¼ã®å®Œäº†ã«å¤±æ•—ã—ã¾ã—ãŸ',
    message: 'èªè¨¼æƒ…å ±ã®å‡¦ç†ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚',
    actionText: 'ã‚„ã‚Šç›´ã™',
    showHelp: true,
  },
  OAuthCreateAccount: {
    type: 'create',
    title: 'ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆã«å¤±æ•—ã—ã¾ã—ãŸ',
    message: 'ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ä½œæˆã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚',
    actionText: 'ã‚‚ã†ä¸€åº¦è©¦ã™',
    showHelp: true,
  },
  EmailCreateAccount: {
    type: 'email',
    title: 'ãƒ¡ãƒ¼ãƒ«èªè¨¼ã«å¤±æ•—ã—ã¾ã—ãŸ',
    message: 'ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒæ­£ã—ã„ã‹ã”ç¢ºèªãã ã•ã„ã€‚',
    actionText: 'ãƒ­ã‚°ã‚¤ãƒ³ã«æˆ»ã‚‹',
    showHelp: true,
  },
  Callback: {
    type: 'callback',
    title: 'èªè¨¼å‡¦ç†ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ',
    message: 'ã—ã°ã‚‰ãæ™‚é–“ã‚’ãŠã„ã¦å†åº¦ãŠè©¦ã—ãã ã•ã„ã€‚',
    actionText: 'ã‚„ã‚Šç›´ã™',
    showHelp: true,
  },
  OAuthAccountNotLinked: {
    type: 'link',
    title: 'ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®é€£æºã«å¤±æ•—ã—ã¾ã—ãŸ',
    message: 'åˆ¥ã®èªè¨¼æ–¹æ³•ã§æ—¢ã«ç™»éŒ²ã•ã‚Œã¦ã„ã‚‹ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã§ã™ã€‚',
    actionText: 'ãƒ­ã‚°ã‚¤ãƒ³ã«æˆ»ã‚‹',
    showHelp: true,
  },
  EmailSignin: {
    type: 'email',
    title: 'ãƒ¡ãƒ¼ãƒ«é€ä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸ',
    message: 'ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒæ­£ã—ã„ã‹ã”ç¢ºèªã®ä¸Šã€å†åº¦ãŠè©¦ã—ãã ã•ã„ã€‚',
    actionText: 'ã‚‚ã†ä¸€åº¦è©¦ã™',
    showHelp: true,
  },
  CredentialsSignin: {
    type: 'credentials',
    title: 'ãƒ­ã‚°ã‚¤ãƒ³æƒ…å ±ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“',
    message: 'ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ã”ç¢ºèªãã ã•ã„ã€‚',
    actionText: 'ãƒ­ã‚°ã‚¤ãƒ³ã«æˆ»ã‚‹',
    showHelp: true,
  },
  SessionRequired: {
    type: 'session',
    title: 'ãƒ­ã‚°ã‚¤ãƒ³ãŒå¿…è¦ã§ã™',
    message: 'ã“ã®ãƒšãƒ¼ã‚¸ã‚’è¡¨ç¤ºã™ã‚‹ã«ã¯ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãã ã•ã„ã€‚',
    actionText: 'ãƒ­ã‚°ã‚¤ãƒ³',
    showHelp: false,
  },
  default: {
    type: 'unknown',
    title: 'äºˆæœŸã—ãªã„ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ',
    message: 'ã—ã°ã‚‰ãæ™‚é–“ã‚’ãŠã„ã¦å†åº¦ãŠè©¦ã—ãã ã•ã„ã€‚',
    actionText: 'ã‚„ã‚Šç›´ã™',
    showHelp: true,
  },
}
```

## 4. èªè¨¼å‡¦ç†ä¸­ç”»é¢

### UIè¦ä»¶ï¼ˆãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ç”»é¢ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         â”‚
â”‚                         â”‚
â”‚          ğŸ”„              â”‚
â”‚                         â”‚
â”‚     èªè¨¼å‡¦ç†ä¸­...        â”‚
â”‚                         â”‚
â”‚   ã—ã°ã‚‰ããŠå¾…ã¡ãã ã•ã„  â”‚
â”‚                         â”‚
â”‚                         â”‚
â”‚  â—â—â—â—‹â—‹ (loading dots)   â”‚
â”‚                         â”‚
â”‚                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å®Ÿè£…ä»•æ§˜

```typescript
const AuthLoadingPage = () => {
  const [dots, setDots] = useState('')

  useEffect(() => {
    const interval = setInterval(() => {
      setDots(prev => {
        if (prev.length >= 3) return ''
        return prev + 'â—'
      })
    }, 500)

    return () => clearInterval(interval)
  }, [])

  return (
    <div className="min-h-screen bg-white flex items-center justify-center">
      <div className="text-center">
        <div className="text-6xl mb-6">ğŸ”„</div>
        <h1 className="text-xl font-semibold mb-2">èªè¨¼å‡¦ç†ä¸­</h1>
        <p className="text-gray-600 mb-6">ã—ã°ã‚‰ããŠå¾…ã¡ãã ã•ã„</p>
        <div className="text-2xl text-primary">
          {dots}
          <span className="text-gray-300">
            {'â—‹'.repeat(3 - dots.length)}
          </span>
        </div>
      </div>
    </div>
  )
}
```

## èªè¨¼ãƒ•ãƒ­ãƒ¼çµ±åˆ

### ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°è¨­è¨ˆ

```typescript
// pages/auth/signin.tsx
export default function SignIn() {
  return <LoginPage />
}

// pages/auth/verify-request.tsx
export default function VerifyRequest() {
  const router = useRouter()
  const { email } = router.query

  return <VerifyRequestPage email={email as string} />
}

// pages/auth/error.tsx
export default function AuthError() {
  const router = useRouter()
  const { error } = router.query

  return <AuthErrorPage error={error as string} />
}
```

### NextAuthè¨­å®šé€£æº

```typescript
// auth.config.ts
export const authConfig = {
  pages: {
    signIn: '/auth/signin',
    verifyRequest: '/auth/verify-request',
    error: '/auth/error',
  },
  callbacks: {
    authorized({ auth, request: { nextUrl } }) {
      const isLoggedIn = !!auth?.user
      const isOnDashboard = nextUrl.pathname.startsWith('/dashboard')

      if (isOnDashboard) {
        if (isLoggedIn) return true
        return false // Redirect unauthenticated users to login page
      } else if (isLoggedIn) {
        return Response.redirect(new URL('/dashboard', nextUrl))
      }

      return true
    },
  },
}
```

### å…±é€šãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ

```typescript
const AuthLayout = ({ children, title }: {
  children: React.ReactNode
  title: string
}) => (
  <div className="min-h-screen bg-gradient-to-b from-green-50 to-white">
    <div className="flex items-center justify-center min-h-screen p-4">
      <div className="w-full max-w-md">
        <div className="text-center mb-8">
          <div className="text-6xl mb-4">ğŸ¥—</div>
          <h1 className="text-2xl font-bold text-gray-900">
            é£Ÿæç®¡ç†ã‚¢ãƒ—ãƒª
          </h1>
          <p className="text-gray-600 mt-2">
            {title}
          </p>
        </div>

        <div className="bg-white rounded-lg shadow-lg p-6">
          {children}
        </div>

        <div className="text-center mt-6 text-xs text-gray-500">
          Â© 2025 é£Ÿæç®¡ç†ã‚¢ãƒ—ãƒª
        </div>
      </div>
    </div>
  </div>
)
```

## ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£

### ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ç®¡ç†

- **åˆæœŸãƒ•ã‚©ãƒ¼ã‚«ã‚¹**: ãƒ¡ãƒ¼ãƒ«å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«è‡ªå‹•ãƒ•ã‚©ãƒ¼ã‚«ã‚¹
- **ã‚¨ãƒ©ãƒ¼æ™‚**: ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«é©åˆ‡ãªãƒ•ã‚©ãƒ¼ã‚«ã‚¹ç§»å‹•
- **ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³**: Tabé †åºã®æœ€é©åŒ–

### ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ãƒªãƒ¼ãƒ€ãƒ¼å¯¾å¿œ

- **å‹•çš„ã‚³ãƒ³ãƒ†ãƒ³ãƒ„**: aria-live ã§ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å¤‰æ›´ã‚’é€šçŸ¥
- **ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸**: aria-describedby ã§å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¨é–¢é€£ä»˜ã‘
- **ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹**: aria-busy ã§ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ã‚’é€šçŸ¥

## ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è€ƒæ…®

### CSRFå¯¾ç­–

- NextAuthæ¨™æº–ã®CSRFä¿è­·ã‚’æ´»ç”¨
- ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡æ™‚ã®CSRFãƒˆãƒ¼ã‚¯ãƒ³æ¤œè¨¼

### ãƒ¬ãƒ¼ãƒˆåˆ¶é™

```typescript
const rateLimiter = new Map()

const checkRateLimit = (email: string): boolean => {
  const now = Date.now()
  const attempts = rateLimiter.get(email) || []

  // éå»1æ™‚é–“ã®è©¦è¡Œå›æ•°ã‚’ãƒã‚§ãƒƒã‚¯
  const recentAttempts = attempts.filter(
    (time: number) => now - time < 3600000 // 1 hour
  )

  if (recentAttempts.length >= 5) {
    return false // Rate limit exceeded
  }

  rateLimiter.set(email, [...recentAttempts, now])
  return true
}
```

## ä»Šå¾Œã®æ‹¡å¼µ

### ãƒ•ã‚§ãƒ¼ã‚º2æ©Ÿèƒ½

- **ã‚½ãƒ¼ã‚·ãƒ£ãƒ«ãƒ­ã‚°ã‚¤ãƒ³**: Googleã€Appleèªè¨¼ã®è¿½åŠ 
- **2è¦ç´ èªè¨¼**: SMSèªè¨¼ã®è¿½åŠ ã‚ªãƒ—ã‚·ãƒ§ãƒ³
- **ç”Ÿä½“èªè¨¼**: Face IDã€Touch IDå¯¾å¿œ

### ãƒ•ã‚§ãƒ¼ã‚º3æ©Ÿèƒ½

- **SSOé€£æº**: ä¼æ¥­å‘ã‘SSOå¯¾å¿œ
- **ã‚¢ã‚«ã‚¦ãƒ³ãƒˆé€£æº**: è¤‡æ•°èªè¨¼æ–¹æ³•ã®çµ±åˆç®¡ç†
- **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ­ã‚°**: ãƒ­ã‚°ã‚¤ãƒ³å±¥æ­´ã®è©³ç´°è¡¨ç¤º
